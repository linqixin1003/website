#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import os
import re
from pathlib import Path
import html

# 英文到葡萄牙语翻译映射
translation_map = {
    # 页面标题
    "Birdwatching Beginner's Guide": "Guia do Iniciante em Observação de Aves",
    "BirdAiSnap": "BirdAiSnap",
    "Essential Equipment": "Equipamentos Essenciais",
    "Identification Techniques": "Técnicas de Identificação", 
    "Best Locations": "Melhores Locais",
    "Seasonal Guide": "Guia Sazonal",
    "Photography Tips": "Dicas de Fotografia",
    "Behavior Observation": "Observação de Comportamento",
    "Song Identification": "Identificação de Cantos",
    "Ethics and Conservation": "Ética e Conservação",
    "Journal Keeping": "Manutenção de Diário",
    "Advanced Techniques": "Técnicas Avançadas",
    "Choosing the Right Bird": "Escolhendo a Ave Certa",
    "Pet Care Guide": "Guia de Cuidados com Animais",
    "Nutrition and Feeding": "Nutrição e Alimentação",
    "Housing and Environment": "Habitação e Ambiente",
    "Health and Veterinary": "Saúde e Veterinária",
    "Training and Behavior": "Treinamento e Comportamento",
    "Breeding and Reproduction": "Reprodução e Criação",
    "Emergency First Aid": "Primeiros Socorros de Emergência",
    "Seasonal Care": "Cuidados Sazonais",
    "Enrichment Activities": "Atividades de Enriquecimento",
    "Senior Bird Care": "Cuidados com Aves Idosas",
    "Species Profiles": "Perfis de Espécies",
    "Bird Flight Mechanics": "Mecânica do Voo das Aves",
    "Magnetic Navigation": "Navegação Magnética",
    "Hummingbird Mechanics": "Mecânica dos Beija-flores",
    "Bird Intelligence": "Inteligência das Aves",
    "Feather Structure": "Estrutura das Penas",
    "Bird Vision": "Visão das Aves",
    "Egg Development": "Desenvolvimento do Ovo",
    "Bird Communication": "Comunicação das Aves",
    "Migration Physiology": "Fisiologia da Migração",
    "Biomechanics": "Biomecânica",
    "Habitat Ecosystems": "Ecossistemas de Habitat",
    "Food Webs Chains": "Cadeias Alimentares",
    "Migration Patterns": "Padrões de Migração",
    "Breeding Ecology": "Ecologia Reprodutiva",
    "Climate Change Impact": "Impacto das Mudanças Climáticas",
    "Urban Ecology": "Ecologia Urbana",
    "Conservation Biology": "Biologia da Conservação",
    "Island Biogeography": "Biogeografia de Ilhas",
    "Pollination Seed Dispersal": "Polinização e Dispersão de Sementes",
    "Community Dynamics": "Dinâmica Comunitária",
    
    # 长句翻译
    "Begin your birdwatching journey and discover the wonders of nature": "Inicie sua jornada de observação de aves e descubra as maravilhas da natureza",
    "Find the perfect feathered companion that matches your lifestyle": "Encontre o companheiro emplumado perfeito que combine com seu estilo de vida",
    "Birdwatching is a fascinating outdoor activity that not only brings you closer to nature but also cultivates patience, focus, and a deep understanding of ecological environments": "A observação de aves é uma atividade fascinante ao ar livre que não apenas o aproxima da natureza, mas também cultiva paciência, foco e uma compreensão profunda dos ambientes ecológicos",
    "Whether you're a complete beginner or a nature enthusiast with some experience, birdwatching can open a magical door to the natural world": "Seja você um iniciante completo ou um entusiasta da natureza com alguma experiência, a observação de aves pode abrir uma porta mágica para o mundo natural",
    
    # 常用短语
    "Why Choose Birdwatching?": "Por que Escolher a Observação de Aves?",
    "Essential Knowledge for Beginners": "Conhecimento Essencial para Iniciantes",
    "Recommended Basic Equipment": "Equipamentos Básicos Recomendados",
    "Birdwatching Etiquette and Safety": "Etiqueta e Segurança na Observação de Aves",
    "Beginner's Tip": "Dica para Iniciantes",
    "Expert Advice": "Conselho de Especialista",
    "Understanding Your Lifestyle": "Compreendendo Seu Estilo de Vida",
    "Popular Pet Bird Types": "Tipos Populares de Aves de Estimação",
    "Space and Housing Requirements": "Requisitos de Espaço e Habitação",
    "Financial Considerations": "Considerações Financeiras",
    "Important Considerations": "Considerações Importantes",
    "Pre-Adoption Checklist": "Lista de Verificação Pré-Adoção",
    "Where to Find Your Bird": "Onde Encontrar Sua Ave",
    "Making Your Final Decision": "Tomando Sua Decisão Final",
    "Red Flags to Avoid": "Sinais de Alerta a Evitar",
    "Space Tip": "Dica de Espaço",
    "Back Button": "Botão Voltar",
    "Hero Image": "Imagem Principal",
    "Main Content": "Conteúdo Principal",
    "Progress Bar": "Barra de Progresso",
    "Update time": "Atualizar tempo",
    "Simulate reading progress": "Simular progresso de leitura",
    "Initialize": "Inicializar",
    
    # 基本词汇
    "birdwatching": "observação de aves",
    "bird": "ave",
    "birds": "aves",
    "nature": "natureza",
    "wildlife": "vida selvagem",
    "habitat": "habitat",
    "species": "espécie",
    "observation": "observação",
    "identification": "identificação",
    "behavior": "comportamento",
    "behaviour": "comportamento",
    "migration": "migração",
    "breeding": "reprodução",
    "feeding": "alimentação",
    "nesting": "nidificação",
    "conservation": "conservação",
    "ecology": "ecologia",
    "ecosystem": "ecossistema",
    "environment": "ambiente",
    "binoculars": "binóculos",
    "equipment": "equipamento",
    "guide": "guia",
    "field guide": "guia de campo",
    "photography": "fotografia",
    "camera": "câmera",
    "notebook": "caderno",
    "journal": "diário",
    "record": "registro",
    "location": "localização",
    "season": "estação",
    "weather": "clima",
    "climate": "clima",
    "temperature": "temperatura",
    "morning": "manhã",
    "evening": "noite",
    "dawn": "amanhecer",
    "dusk": "crepúsculo",
    "forest": "floresta",
    "grassland": "pastagem",
    "wetland": "área úmida",
    "lake": "lago",
    "river": "rio",
    "mountain": "montanha",
    "park": "parque",
    "garden": "jardim",
    "urban": "urbano",
    "rural": "rural",
    "wild": "selvagem",
    "domestic": "doméstico",
    "pet": "animal de estimação",
    "care": "cuidado",
    "health": "saúde",
    "nutrition": "nutrição",
    "diet": "dieta",
    "food": "comida",
    "water": "água",
    "shelter": "abrigo",
    "cage": "gaiola",
    "veterinary": "veterinário",
    "medicine": "medicina",
    "treatment": "tratamento",
    "disease": "doença",
    "injury": "lesão",
    "emergency": "emergência",
    "first aid": "primeiros socorros",
    "training": "treinamento",
    "intelligence": "inteligência",
    "learning": "aprendizagem",
    "communication": "comunicação",
    "song": "canto",
    "call": "chamado",
    "sound": "som",
    "voice": "voz",
    "flight": "voo",
    "wing": "asa",
    "feather": "pena",
    "beak": "bico",
    "eye": "olho",
    "leg": "perna",
    "foot": "pé",
    "tail": "cauda",
    "size": "tamanho",
    "color": "cor",
    "colour": "cor",
    "pattern": "padrão",
    "male": "macho",
    "female": "fêmea",
    "adult": "adulto",
    "juvenile": "juvenil",
    "chick": "filhote",
    "egg": "ovo",
    "nest": "ninho",
    "territory": "território",
    "flock": "bando",
    "pair": "par",
    "mate": "companheiro",
    "reproduction": "reprodução",
    "predator": "predador",
    "prey": "presa",
    "hunting": "caça",
    "foraging": "forrageamento",
    "seed": "semente",
    "fruit": "fruta",
    "insect": "inseto",
    "fish": "peixe",
    
    # 鸟类名称
    "sparrows": "pardais",
    "pigeons": "pombos",
    "crows": "corvos",
    "budgerigars": "periquitos",
    "budgies": "periquitos",
    "cockatiels": "calopsitas",
    "lovebirds": "agapornis",
    "canaries": "canários",
    "conures": "jandaias",
    "macaws": "araras",
    "cockatoos": "cacatuas",
    "parrots": "papagaios",
    "finches": "pintassilgos",
    
    # 常用词汇
    "and": "e",
    "or": "ou",
    "the": "o",
    "a": "um",
    "an": "um",
    "is": "é",
    "are": "são",
    "will": "vai",
    "can": "pode",
    "should": "deveria",
    "must": "deve",
    "have": "ter",
    "has": "tem",
    "with": "com",
    "for": "para",
    "to": "para",
    "of": "de",
    "in": "em",
    "on": "em",
    "at": "em",
    "by": "por",
    "from": "de",
    "about": "sobre",
    "during": "durante",
    "before": "antes",
    "after": "depois",
    "when": "quando",
    "where": "onde",
    "how": "como",
    "what": "o que",
    "why": "por que",
    "which": "qual",
    "that": "que",
    "this": "este",
    "these": "estes",
    "those": "aqueles",
    "all": "todos",
    "some": "alguns",
    "many": "muitos",
    "most": "maioria",
    "few": "poucos",
    "each": "cada",
    "every": "todo",
    "other": "outro",
    "first": "primeiro",
    "second": "segundo",
    "last": "último",
    "next": "próximo",
    "new": "novo",
    "old": "velho",
    "young": "jovem",
    "small": "pequeno",
    "large": "grande",
    "big": "grande",
    "little": "pequeno",
    "long": "longo",
    "short": "curto",
    "high": "alto",
    "low": "baixo",
    "good": "bom",
    "bad": "ruim",
    "best": "melhor",
    "better": "melhor",
    "important": "importante",
    "necessary": "necessário",
    "useful": "útil",
    "helpful": "útil",
    "easy": "fácil",
    "difficult": "difícil",
    "hard": "difícil",
    "simple": "simples",
    "complex": "complexo",
    "common": "comum",
    "rare": "raro",
    "special": "especial",
    "different": "diferente",
    "same": "mesmo",
    "similar": "similar",
    "various": "vários",
    "natural": "natural",
    "safe": "seguro",
    "dangerous": "perigoso",
    "beautiful": "bonito",
    "amazing": "incrível",
    "wonderful": "maravilhoso",
    "interesting": "interessante",
    "exciting": "emocionante",
    "peaceful": "pacífico",
    "quiet": "silencioso",
    "loud": "barulhento",
    "active": "ativo",
    "busy": "ocupado",
    "slow": "lento",
    "fast": "rápido",
    "quick": "rápido",
    "early": "cedo",
    "late": "tarde",
    "daily": "diário",
    "local": "local",
    "personal": "pessoal",
    "professional": "profissional",
    "scientific": "científico",
    "practical": "prático",
    "effective": "eficaz",
    "popular": "popular",
    "experienced": "experiente",
    "skilled": "habilidoso",
    "expert": "especialista",
    "beginner": "iniciante",
    "advanced": "avançado",
    "basic": "básico",
    "essential": "essencial",
    "primary": "primário",
    "main": "principal",
    "major": "principal",
    "key": "chave",
    "significant": "significativo",
    "complete": "completo",
    "full": "completo",
    "total": "total",
    "general": "geral",
    "specific": "específico",
    "individual": "individual",
    "single": "único",
    "multiple": "múltiplo",
    "unique": "único",
    "typical": "típico",
    "normal": "normal",
    "regular": "regular",
    "standard": "padrão",
    "average": "médio",
    "excellent": "excelente",
    "perfect": "perfeito",
    "suitable": "adequado",
    "appropriate": "apropriado",
    "proper": "adequado",
    "correct": "correto",
    "right": "certo",
    "wrong": "errado",
    "true": "verdadeiro",
    "real": "real",
    "possible": "possível",
    "likely": "provável",
    "certain": "certo",
    "clear": "claro",
    "obvious": "óbvio",
    "visible": "visível",
    "available": "disponível",
    "convenient": "conveniente",
    "comfortable": "confortável",
    "enjoyable": "agradável",
    "fun": "divertido",
    "educational": "educacional",
    "valuable": "valioso",
    "expensive": "caro",
    "cheap": "barato",
    "free": "grátis",
    
    # 动词
    "learn": "aprender",
    "teach": "ensinar",
    "understand": "entender",
    "know": "saber",
    "think": "pensar",
    "see": "ver",
    "look": "olhar",
    "watch": "assistir",
    "observe": "observar",
    "find": "encontrar",
    "discover": "descobrir",
    "start": "começar",
    "begin": "começar",
    "continue": "continuar",
    "stop": "parar",
    "finish": "terminar",
    "complete": "completar",
    "make": "fazer",
    "create": "criar",
    "build": "construir",
    "plan": "planejar",
    "prepare": "preparar",
    "provide": "fornecer",
    "give": "dar",
    "take": "pegar",
    "get": "obter",
    "keep": "manter",
    "hold": "segurar",
    "carry": "carregar",
    "bring": "trazer",
    "send": "enviar",
    "receive": "receber",
    "save": "salvar",
    "protect": "proteger",
    "help": "ajudar",
    "support": "apoiar",
    "try": "tentar",
    "practice": "praticar",
    "work": "trabalhar",
    "play": "brincar",
    "live": "viver",
    "stay": "ficar",
    "come": "vir",
    "go": "ir",
    "move": "mover",
    "walk": "caminhar",
    "run": "correr",
    "fly": "voar",
    "swim": "nadar",
    "eat": "comer",
    "drink": "beber",
    "sleep": "dormir",
    "rest": "descansar",
    "feel": "sentir",
    "hear": "ouvir",
    "listen": "escutar",
    "speak": "falar",
    "talk": "conversar",
    "say": "dizer",
    "tell": "contar",
    "ask": "perguntar",
    "answer": "responder",
    "show": "mostrar",
    "explain": "explicar",
    "describe": "descrever",
    "choose": "escolher",
    "select": "selecionar",
    "decide": "decidir",
    "prefer": "preferir",
    "like": "gostar",
    "love": "amar",
    "enjoy": "desfrutar",
    "want": "querer",
    "need": "precisar",
    "require": "exigir",
    "use": "usar",
    "spend": "gastar",
    "visit": "visitar",
    "travel": "viajar",
    "return": "retornar",
    "leave": "sair",
    "enter": "entrar",
    "open": "abrir",
    "close": "fechar",
    "turn": "virar",
    "change": "mudar",
    "become": "tornar-se",
    "grow": "crescer",
    "develop": "desenvolver",
    "improve": "melhorar",
    "increase": "aumentar",
    "decrease": "diminuir",
    "reduce": "reduzir",
    "add": "adicionar",
    "remove": "remover",
    "include": "incluir",
    "contain": "conter",
    "follow": "seguir",
    "lead": "liderar",
    "guide": "guiar",
    "control": "controlar",
    "manage": "gerenciar",
    "handle": "lidar",
    "deal": "lidar",
    "solve": "resolver",
    "fix": "consertar",
    "repair": "reparar",
    "maintain": "manter",
    "check": "verificar",
    "test": "testar",
    "measure": "medir",
    "count": "contar",
    "compare": "comparar",
    "match": "combinar",
    "fit": "caber",
    "suit": "adequar",
    "meet": "encontrar",
    "join": "juntar",
    "connect": "conectar",
    "combine": "combinar",
    "share": "compartilhar",
    "divide": "dividir",
    "separate": "separar",
    "break": "quebrar",
    "cut": "cortar",
    "clean": "limpar",
    "wash": "lavar",
    "cook": "cozinhar",
    "serve": "servir",
    "offer": "oferecer",
    "sell": "vender",
    "buy": "comprar",
    "pay": "pagar",
    "cost": "custar",
    "worth": "valer",
    "own": "possuir",
    "belong": "pertencer",
    "exist": "existir",
    "happen": "acontecer",
    "occur": "ocorrer",
    "appear": "aparecer",
    "seem": "parecer",
    "sound": "soar",
    "smell": "cheirar",
    "taste": "provar",
    "touch": "tocar",
    "reach": "alcançar",
    "arrive": "chegar",
    "wait": "esperar",
    "expect": "esperar",
    "hope": "esperar",
    "wish": "desejar",
    "believe": "acreditar",
    "trust": "confiar",
    "remember": "lembrar",
    "forget": "esquecer",
    "remind": "lembrar",
    "notice": "notar",
    "realize": "perceber",
    "recognize": "reconhecer",
    "identify": "identificar",
    "consider": "considerar",
    "suggest": "sugerir",
    "recommend": "recomendar",
    "advise": "aconselhar",
    "warn": "avisar",
    "inform": "informar",
    "announce": "anunciar",
    "agree": "concordar",
    "disagree": "discordar",
    "accept": "aceitar",
    "refuse": "recusar",
    "allow": "permitir",
    "permit": "permitir",
    "forbid": "proibir",
    "avoid": "evitar",
    "prevent": "prevenir",
    "cause": "causar",
    "result": "resultar",
    "succeed": "ter sucesso",
    "fail": "falhar",
    "win": "ganhar",
    "lose": "perder",
    "beat": "bater",
    "defeat": "derrotar",
    "compete": "competir",
    "fight": "lutar",
    "attack": "atacar",
    "defend": "defender",
    "escape": "escapar",
    "hide": "esconder",
    "seek": "procurar",
    "search": "buscar",
    "hunt": "caçar",
    "catch": "pegar",
    "release": "soltar",
    "drop": "derrubar",
    "pick": "escolher",
    "gather": "reunir",
    "collect": "coletar",
    "store": "armazenar",
    "lose": "perder",
    "miss": "perder",
    "waste": "desperdiçar",
    "save": "economizar",
    "earn": "ganhar",
    "gain": "ganhar",
    "achieve": "alcançar",
    "reach": "alcançar",
    "obtain": "obter",
    "acquire": "adquirir",
    "receive": "receber",
    "accept": "aceitar",
    "reject": "rejeitar",
    "ignore": "ignorar",
    "focus": "focar",
    "concentrate": "concentrar",
    "relax": "relaxar",
    "worry": "preocupar",
    "care": "cuidar",
    "mind": "importar",
    "matter": "importar",
    "concern": "preocupar",
    "involve": "envolver",
    "participate": "participar",
    "attend": "participar",
    "organize": "organizar",
    "arrange": "organizar",
    "schedule": "agendar",
    "book": "reservar",
    "reserve": "reservar",
    "order": "pedir",
    "request": "solicitar",
    "demand": "exigir",
    "supply": "fornecer",
    "deliver": "entregar",
    "transport": "transportar",
    "carry": "carregar",
    "load": "carregar",
    "unload": "descarregar",
    "pack": "embalar",
    "unpack": "desembalar",
    "wrap": "embrulhar",
    "unwrap": "desembrulhar",
    "cover": "cobrir",
    "uncover": "descobrir",
    "hide": "esconder",
    "reveal": "revelar",
    "expose": "expor",
    "display": "exibir",
    "present": "apresentar",
    "introduce": "apresentar",
    "represent": "representar",
    "stand": "ficar em pé",
    "sit": "sentar",
    "lie": "deitar",
    "kneel": "ajoelhar",
    "bend": "dobrar",
    "stretch": "esticar",
    "lift": "levantar",
    "raise": "levantar",
    "lower": "abaixar",
    "push": "empurrar",
    "pull": "puxar",
    "throw": "jogar",
    "kick": "chutar",
    "hit": "bater",
    "strike": "bater",
    "knock": "bater",
    "ring": "tocar",
    "call": "chamar",
    "shout": "gritar",
    "whisper": "sussurrar",
    "sing": "cantar",
    "dance": "dançar",
    "jump": "pular",
    "climb": "escalar",
    "fall": "cair",
    "rise": "subir",
    "set": "definir",
    "put": "colocar",
    "place": "colocar",
    "position": "posicionar",
    "locate": "localizar",
    "explore": "explorar",
    "investigate": "investigar",
    "research": "pesquisar",
    "study": "estudar",
    "examine": "examinar",
    "analyze": "analisar",
    "evaluate": "avaliar",
    "assess": "avaliar",
    "judge": "julgar",
    "determine": "determinar",
    "conclude": "concluir",
    "assume": "assumir",
    "suppose": "supor",
    "guess": "adivinhar",
    "estimate": "estimar",
    "calculate": "calcular",
    "predict": "prever",
    "forecast": "prever",
    "design": "projetar",
    "draft": "rascunhar",
    "write": "escrever",
    "read": "ler",
    "spell": "soletrar",
    "type": "digitar",
    "print": "imprimir",
    "copy": "copiar",
    "paste": "colar",
    "delete": "deletar",
    "edit": "editar",
    "revise": "revisar",
    "correct": "corrigir",
    "adjust": "ajustar",
    "modify": "modificar",
    "alter": "alterar",
    "transform": "transformar",
    "convert": "converter",
    "translate": "traduzir",
    "interpret": "interpretar",
    "mean": "significar",
    "refer": "referir",
    "mention": "mencionar",
    "discuss": "discutir",
    "debate": "debater",
    "argue": "argumentar",
    "claim": "afirmar",
    "state": "declarar",
    "declare": "declarar",
    "report": "relatar",
    "define": "definir",
    "clarify": "esclarecer",
    "confirm": "confirmar",
    "verify": "verificar",
    "prove": "provar",
    "demonstrate": "demonstrar",
    "illustrate": "ilustrar",
    
    # 更多名词
    "time": "tempo",
    "day": "dia",
    "night": "noite",
    "week": "semana",
    "month": "mês",
    "year": "ano",
    "hour": "hora",
    "minute": "minuto",
    "second": "segundo",
    "moment": "momento",
    "period": "período",
    "age": "idade",
    "life": "vida",
    "death": "morte",
    "birth": "nascimento",
    "family": "família",
    "parent": "pai",
    "child": "criança",
    "baby": "bebê",
    "man": "homem",
    "woman": "mulher",
    "boy": "menino",
    "girl": "menina",
    "friend": "amigo",
    "enemy": "inimigo",
    "stranger": "estranho",
    "neighbor": "vizinho",
    "community": "comunidade",
    "society": "sociedade",
    "country": "país",
    "city": "cidade",
    "town": "cidade",
    "village": "vila",
    "place": "lugar",
    "position": "posição",
    "spot": "local",
    "site": "local",
    "area": "área",
    "region": "região",
    "zone": "zona",
    "space": "espaço",
    "room": "quarto",
    "house": "casa",
    "home": "casa",
    "building": "prédio",
    "structure": "estrutura",
    "wall": "parede",
    "door": "porta",
    "window": "janela",
    "floor": "chão",
    "ceiling": "teto",
    "roof": "telhado",
    "stairs": "escadas",
    "table": "mesa",
    "chair": "cadeira",
    "bed": "cama",
    "book": "livro",
    "paper": "papel",
    "pen": "caneta",
    "pencil": "lápis",
    "computer": "computador",
    "phone": "telefone",
    "car": "carro",
    "bus": "ônibus",
    "train": "trem",
    "plane": "avião",
    "boat": "barco",
    "ship": "navio",
    "bicycle": "bicicleta",
    "money": "dinheiro",
    "price": "preço",
    "cost": "custo",
    "value": "valor",
    "business": "negócio",
    "company": "empresa",
    "job": "trabalho",
    "work": "trabalho",
    "office": "escritório",
    "school": "escola",
    "student": "estudante",
    "teacher": "professor",
    "doctor": "médico",
    "hospital": "hospital",
    "medicine": "remédio",
    "health": "saúde",
    "body": "corpo",
    "head": "cabeça",
    "face": "rosto",
    "hand": "mão",
    "arm": "braço",
    "finger": "dedo",
    "heart": "coração",
    "mind": "mente",
    "soul": "alma",
    "spirit": "espírito",
    "feeling": "sentimento",
    "emotion": "emoção",
    "love": "amor",
    "hate": "ódio",
    "fear": "medo",
    "hope": "esperança",
    "dream": "sonho",
    "goal": "objetivo",
    "plan": "plano",
    "idea": "ideia",
    "thought": "pensamento",
    "memory": "memória",
    "experience": "experiência",
    "knowledge": "conhecimento",
    "skill": "habilidade",
    "ability": "capacidade",
    "talent": "talento"
}

def translate_text(text):
    """翻译文本，保持HTML标签不变"""
    if not text.strip():
        return text
    
    # 先处理HTML实体
    text = html.unescape(text)
    
    # 按长度排序，优先匹配长短语
    sorted_keys = sorted(translation_map.keys(), key=len, reverse=True)
    
    for english in sorted_keys:
        if english in text:
            text = text.replace(english, translation_map[english])
    
    return text

def copy_and_translate_file(src_file, dest_file):
    """复制并翻译单个HTML文件"""
    print(f"正在处理: {src_file} -> {dest_file}")
    
    try:
        with open(src_file, 'r', encoding='utf-8') as f:
            content = f.read()
        
        # 更新lang属性
        content = re.sub(r'lang="en"', 'lang="pt"', content)
        
        # 处理title标签
        def translate_title(match):
            title_content = match.group(1)
            translated = translate_text(title_content)
            return f'<title>{translated}</title>'
        
        content = re.sub(r'<title>(.*?)</title>', translate_title, content, flags=re.DOTALL)
        
        # 处理文本内容
        def translate_html_text(match):
            full_match = match.group(0)
            tag_start = match.group(1)
            text_content = match.group(2)
            tag_end = match.group(3)
            
            if text_content.strip():
                # 保留HTML标签（如span）
                if '<span' in text_content or '<a' in text_content or '<strong' in text_content or '<em' in text_content:
                    # 分离文本和HTML标签
                    parts = re.split(r'(<[^>]+>[^<]*</[^>]+>|<[^>]+/>)', text_content)
                    translated_parts = []
                    for part in parts:
                        if part.startswith('<'):
                            translated_parts.append(part)  # 保持HTML标签不变
                        else:
                            translated_parts.append(translate_text(part))
                    translated_text = ''.join(translated_parts)
                else:
                    translated_text = translate_text(text_content)
                
                return tag_start + translated_text + tag_end
            
            return full_match
        
        # 匹配各种HTML标签
        html_tags = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'div', 'span', 'a', 'li', 'td', 'th', 'cite', 'button']
        
        for tag in html_tags:
            pattern = f'(<{tag}[^>]*>)(.*?)(</{tag}>)'
            content = re.sub(pattern, translate_html_text, content, flags=re.DOTALL)
        
        # 处理注释中的文本
        def translate_comment(match):
            comment_text = match.group(1)
            translated = translate_text(comment_text)
            return f'<!-- {translated} -->'
        
        content = re.sub(r'<!--\s*(.*?)\s*-->', translate_comment, content, flags=re.DOTALL)
        
        # 确保目标目录存在
        dest_file.parent.mkdir(parents=True, exist_ok=True)
        
        # 写入目标文件
        with open(dest_file, 'w', encoding='utf-8') as f:
            f.write(content)
        
        print(f"✅ 完成: {dest_file}")
        
    except Exception as e:
        print(f"❌ 错误处理 {src_file}: {str(e)}")

def main():
    """主函数"""
    en_dir = Path("en")
    pt_dir = Path("pt")
    
    if not en_dir.exists():
        print("❌ en目录不存在")
        return
    
    # 查找所有英文HTML文件
    html_files = list(en_dir.rglob("*.html"))
    
    if not html_files:
        print("❌ 在en目录中未找到HTML文件")
        return
    
    print(f"找到 {len(html_files)} 个英文HTML文件")
    print("开始翻译成葡萄牙语...")
    
    for html_file in html_files:
        # 计算相对路径
        relative_path = html_file.relative_to(en_dir)
        dest_file = pt_dir / relative_path
        
        copy_and_translate_file(html_file, dest_file)
    
    print(f"\n🎉 翻译完成！共处理了 {len(html_files)} 个文件")
    print(f"英文文件已翻译成葡萄牙语并保存到 pt/ 目录")

if __name__ == "__main__":
    main()
