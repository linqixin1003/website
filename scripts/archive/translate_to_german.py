#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import os
import re
from pathlib import Path
import html

def translate_to_german():
    """英文到德语翻译函数"""
    
    # 英文到德语翻译映射
    translations = {
        # 完整标题和句子（优先匹配）
        "Birdwatching Beginner's Guide": "Vogelbeobachtung Anfängerhandbuch",
        "Begin your birdwatching journey and discover the wonders of nature": "Beginnen Sie Ihre Vogelbeobachtungsreise und entdecken Sie die Wunder der Natur",
        "Find the perfect feathered companion that matches your lifestyle": "Finden Sie den perfekten gefiederten Begleiter, der zu Ihrem Lebensstil passt",
        
        # 长段落翻译
        "Birdwatching is a fascinating outdoor activity that not only brings you closer to nature but also cultivates patience, focus, and a deep understanding of ecological environments": "Vogelbeobachtung ist eine faszinierende Outdoor-Aktivität, die Sie nicht nur der Natur näher bringt, sondern auch Geduld, Konzentration und ein tiefes Verständnis für ökologische Umgebungen kultiviert",
        
        "Whether you're a complete beginner or a nature enthusiast with some experience, birdwatching can open a magical door to the natural world": "Ob Sie ein kompletter Anfänger oder ein Naturliebhaber mit etwas Erfahrung sind, Vogelbeobachtung kann eine magische Tür zur natürlichen Welt öffnen",
        
        # 章节标题
        "Why Choose Birdwatching?": "Warum Vogelbeobachtung wählen?",
        "Essential Knowledge for Beginners": "Wesentliches Wissen für Anfänger",
        "Recommended Basic Equipment": "Empfohlene Grundausstattung",
        "Birdwatching Etiquette and Safety": "Vogelbeobachtung Etikette und Sicherheit",
        
        # 提示框标题
        "Beginner's Tip": "Anfänger-Tipp",
        "Expert Advice": "Expertenrat",
        "Space Tip": "Platz-Tipp",
        
        # 页面元素
        "Back Button": "Zurück-Taste",
        "Hero Image": "Hauptbild",
        "Main Content": "Hauptinhalt",
        "Progress Bar": "Fortschrittsbalken",
        
        # 其他页面标题
        "Essential Equipment": "Wesentliche Ausrüstung",
        "Identification Techniques": "Identifikationstechniken",
        "Best Locations": "Beste Standorte",
        "Seasonal Guide": "Saisonaler Leitfaden",
        "Photography Tips": "Fotografie-Tipps",
        "Behavior Observation": "Verhaltensbeobachtung",
        "Song Identification": "Gesangsidentifikation",
        "Ethics and Conservation": "Ethik und Naturschutz",
        "Journal Keeping": "Tagebuchführung",
        "Choosing the Right Bird": "Den richtigen Vogel wählen",
        "Nutrition and Feeding": "Ernährung und Fütterung",
        "Housing and Environment": "Unterbringung und Umgebung",
        "Health and Veterinary": "Gesundheit und Tierarzt",
        "Training and Behavior": "Training und Verhalten",
        "Breeding and Reproduction": "Zucht und Fortpflanzung",
        "Emergency First Aid": "Notfall-Erste Hilfe",
        "Seasonal Care": "Saisonale Pflege",
        "Enrichment Activities": "Bereicherungsaktivitäten",
        "Senior Bird Care": "Altenvogelpflege",
        "Species Profiles": "Artenprofile",
        
        # 科学奇迹标题
        "Bird Flight Mechanics": "Vogelflug-Mechanik",
        "Magnetic Navigation": "Magnetische Navigation",
        "Hummingbird Mechanics": "Kolibri-Mechanik",
        "Bird Intelligence": "Vogelintelligenz",
        "Feather Structure": "Federstruktur",
        "Bird Vision": "Vogelsicht",
        "Egg Development": "Eientwicklung",
        "Bird Communication": "Vogelkommunikation",
        "Migration Physiology": "Migrationsphysiologie",
        "Biomechanics": "Biomechanik",
        
        # 生态学标题
        "Habitat Ecosystems": "Lebensraum-Ökosysteme",
        "Food Webs Chains": "Nahrungsnetze und -ketten",
        "Migration Patterns": "Migrationsmuster",
        "Breeding Ecology": "Brutökologie",
        "Climate Change Impact": "Klimawandel-Auswirkungen",
        "Urban Ecology": "Stadtökologie",
        "Conservation Biology": "Naturschutzbiologie",
        "Island Biogeography": "Insel-Biogeographie",
        "Pollination Seed Dispersal": "Bestäubung und Samenverbreitung",
        "Community Dynamics": "Gemeinschaftsdynamik",
        
        # 常用短语
        "It's recommended to start by observing common birds, such as sparrows, pigeons, and crows. These birds are easy to observe and help build confidence and experience.": "Es wird empfohlen, mit der Beobachtung häufiger Vögel wie Spatzen, Tauben und Krähen zu beginnen. Diese Vögel sind leicht zu beobachten und helfen beim Aufbau von Vertrauen und Erfahrung.",
        
        "Joining local birdwatching organizations or participating in birdwatching activities to learn from experienced birdwatchers is the best way to quickly improve your birdwatching skills.": "Der Beitritt zu örtlichen Vogelbeobachtungsorganisationen oder die Teilnahme an Vogelbeobachtungsaktivitäten, um von erfahrenen Vogelbeobachtern zu lernen, ist der beste Weg, um Ihre Vogelbeobachtungsfähigkeiten schnell zu verbessern.",
        
        # 基本词汇
        "birdwatching": "Vogelbeobachtung",
        "bird": "Vogel",
        "birds": "Vögel",
        "nature": "Natur",
        "wildlife": "Tierwelt",
        "habitat": "Lebensraum",
        "species": "Art",
        "observation": "Beobachtung",
        "identification": "Identifikation",
        "behavior": "Verhalten",
        "behaviour": "Verhalten",
        "migration": "Migration",
        "breeding": "Zucht",
        "feeding": "Fütterung",
        "conservation": "Naturschutz",
        "ecology": "Ökologie",
        "ecosystem": "Ökosystem",
        "environment": "Umgebung",
        "equipment": "Ausrüstung",
        "binoculars": "Fernglas",
        "guide": "Leitfaden",
        "photography": "Fotografie",
        "camera": "Kamera",
        "notebook": "Notizbuch",
        "journal": "Tagebuch",
        "location": "Standort",
        "season": "Jahreszeit",
        "weather": "Wetter",
        "temperature": "Temperatur",
        "morning": "Morgen",
        "evening": "Abend",
        "forest": "Wald",
        "park": "Park",
        "garden": "Garten",
        "urban": "städtisch",
        "rural": "ländlich",
        "wild": "wild",
        "domestic": "häuslich",
        "pet": "Haustier",
        "care": "Pflege",
        "health": "Gesundheit",
        "nutrition": "Ernährung",
        "food": "Nahrung",
        "water": "Wasser",
        "training": "Training",
        "intelligence": "Intelligenz",
        "communication": "Kommunikation",
        "flight": "Flug",
        "feather": "Feder",
        "wing": "Flügel",
        "beak": "Schnabel",
        "eye": "Auge",
        "size": "Größe",
        "color": "Farbe",
        "colour": "Farbe",
        "male": "männlich",
        "female": "weiblich",
        "adult": "erwachsen",
        "egg": "Ei",
        "nest": "Nest",
        
        # 常用动词
        "learn": "lernen",
        "understand": "verstehen",
        "observe": "beobachten",
        "find": "finden",
        "discover": "entdecken",
        "start": "beginnen",
        "begin": "anfangen",
        "help": "helfen",
        "choose": "wählen",
        "need": "brauchen",
        "want": "wollen",
        "like": "mögen",
        "see": "sehen",
        "watch": "beobachten",
        "listen": "hören",
        "build": "bauen",
        "create": "erstellen",
        "provide": "bereitstellen",
        "protect": "schützen",
        "improve": "verbessern",
        "develop": "entwickeln",
        
        # 常用形容词
        "important": "wichtig",
        "essential": "wesentlich",
        "basic": "grundlegend",
        "common": "häufig",
        "different": "unterschiedlich",
        "special": "besonders",
        "natural": "natürlich",
        "beautiful": "schön",
        "interesting": "interessant",
        "easy": "einfach",
        "difficult": "schwierig",
        "good": "gut",
        "best": "beste",
        "new": "neu",
        "old": "alt",
        "small": "klein",
        "large": "groß",
        "long": "lang",
        "short": "kurz",
        "high": "hoch",
        "low": "niedrig",
        "safe": "sicher",
        "local": "örtlich",
        "popular": "beliebt",
        "experienced": "erfahren",
        "perfect": "perfekt",
        "complete": "vollständig",
        "unique": "einzigartig",
        "amazing": "erstaunlich",
        "wonderful": "wunderbar",
        
        # 常用词汇
        "and": "und",
        "or": "oder",
        "the": "der",
        "with": "mit",
        "for": "für",
        "to": "zu",
        "of": "von",
        "in": "in",
        "on": "auf",
        "at": "bei",
        "by": "durch",
        "from": "von",
        "about": "über",
        "during": "während",
        "before": "vor",
        "after": "nach",
        "when": "wann",
        "where": "wo",
        "how": "wie",
        "what": "was",
        "why": "warum",
        "this": "dies",
        "that": "das",
        "these": "diese",
        "those": "jene",
        "all": "alle",
        "some": "einige",
        "many": "viele",
        "most": "meiste",
        "each": "jeder",
        "every": "jeder",
        "first": "erste",
        "last": "letzte",
        "next": "nächste",
        "new": "neu",
        "old": "alt",
        "small": "klein",
        "large": "groß",
        "good": "gut",
        "best": "beste",
        "important": "wichtig",
        "easy": "einfach",
        "difficult": "schwierig",
        "safe": "sicher",
        "beautiful": "schön",
        "interesting": "interessant",
        "amazing": "erstaunlich",
        "wonderful": "wunderbar",
        "perfect": "perfekt",
        "complete": "vollständig",
        "natural": "natürlich",
        "special": "besonders",
        "different": "unterschiedlich",
        "similar": "ähnlich",
        "same": "gleich",
        "other": "andere",
        "another": "ein anderer",
        "more": "mehr",
        "less": "weniger",
        "much": "viel",
        "little": "wenig",
        "few": "wenige",
        "several": "mehrere",
        "various": "verschiedene",
        "certain": "bestimmte",
        "particular": "besondere",
        "specific": "spezifische",
        "general": "allgemeine",
        "main": "Haupt-",
        "major": "Haupt-",
        "minor": "Neben-",
        "primary": "primäre",
        "secondary": "sekundäre",
        "basic": "grundlegend",
        "advanced": "fortgeschritten",
        "simple": "einfach",
        "complex": "komplex",
        "easy": "einfach",
        "hard": "schwer",
        "difficult": "schwierig",
        "possible": "möglich",
        "impossible": "unmöglich",
        "necessary": "notwendig",
        "important": "wichtig",
        "useful": "nützlich",
        "helpful": "hilfreich",
        "effective": "effektiv",
        "successful": "erfolgreich",
        "popular": "beliebt",
        "common": "häufig",
        "rare": "selten",
        "unique": "einzigartig",
        "typical": "typisch",
        "normal": "normal",
        "unusual": "ungewöhnlich",
        "strange": "seltsam",
        "familiar": "vertraut",
        "unknown": "unbekannt",
        "clear": "klar",
        "obvious": "offensichtlich",
        "certain": "sicher",
        "sure": "sicher",
        "confident": "selbstbewusst",
        "careful": "vorsichtig",
        "cautious": "vorsichtig",
        "safe": "sicher",
        "dangerous": "gefährlich",
        "risky": "riskant",
        "secure": "sicher",
        "protected": "geschützt",
        "private": "privat",
        "public": "öffentlich",
        "personal": "persönlich",
        "individual": "individuell",
        "social": "sozial",
        "professional": "professionell",
        "official": "offiziell",
        "formal": "formal",
        "informal": "informell",
        "serious": "ernst",
        "funny": "lustig",
        "interesting": "interessant",
        "boring": "langweilig",
        "exciting": "aufregend",
        "surprising": "überraschend",
        "amazing": "erstaunlich",
        "wonderful": "wunderbar",
        "excellent": "ausgezeichnet",
        "great": "großartig",
        "fantastic": "fantastisch",
        "terrible": "schrecklich",
        "awful": "furchtbar",
        "bad": "schlecht",
        "poor": "schlecht",
        "good": "gut",
        "better": "besser",
        "best": "beste",
        "worse": "schlechter",
        "worst": "schlechteste",
        "fine": "fein",
        "nice": "schön",
        "pleasant": "angenehm",
        "comfortable": "bequem",
        "convenient": "bequem",
        "suitable": "geeignet",
        "appropriate": "angemessen",
        "proper": "richtig",
        "correct": "korrekt",
        "right": "richtig",
        "wrong": "falsch",
        "true": "wahr",
        "false": "falsch",
        "real": "echt",
        "actual": "tatsächlich",
        "genuine": "echt",
        "artificial": "künstlich",
        "natural": "natürlich",
        "original": "original",
        "traditional": "traditionell",
        "modern": "modern",
        "contemporary": "zeitgenössisch",
        "current": "aktuell",
        "recent": "kürzlich",
        "latest": "neueste",
        "future": "zukünftig",
        "past": "vergangen",
        "present": "gegenwärtig",
        "temporary": "vorübergehend",
        "permanent": "dauerhaft",
        "constant": "konstant",
        "regular": "regelmäßig",
        "frequent": "häufig",
        "occasional": "gelegentlich",
        "rare": "selten",
        "never": "nie",
        "always": "immer",
        "usually": "normalerweise",
        "often": "oft",
        "sometimes": "manchmal",
        "seldom": "selten",
        "hardly": "kaum",
        "barely": "kaum",
        "almost": "fast",
        "nearly": "fast",
        "quite": "ziemlich",
        "rather": "ziemlich",
        "very": "sehr",
        "extremely": "extrem",
        "highly": "hoch",
        "completely": "vollständig",
        "totally": "völlig",
        "entirely": "ganz",
        "absolutely": "absolut",
        "definitely": "definitiv",
        "certainly": "sicherlich",
        "probably": "wahrscheinlich",
        "possibly": "möglicherweise",
        "perhaps": "vielleicht",
        "maybe": "vielleicht",
        "likely": "wahrscheinlich",
        "unlikely": "unwahrscheinlich",
        "obviously": "offensichtlich",
        "clearly": "klar",
        "apparently": "anscheinend",
        "evidently": "offensichtlich",
        "fortunately": "glücklicherweise",
        "unfortunately": "unglücklicherweise",
        "luckily": "glücklicherweise",
        "hopefully": "hoffentlich",
        "surprisingly": "überraschenderweise",
        "interestingly": "interessanterweise",
        "importantly": "wichtig",
        "significantly": "bedeutend",
        "particularly": "besonders",
        "especially": "besonders",
        "specifically": "spezifisch",
        "generally": "allgemein",
        "basically": "grundsätzlich",
        "essentially": "im Wesentlichen",
        "mainly": "hauptsächlich",
        "mostly": "meistens",
        "largely": "größtenteils",
        "partly": "teilweise",
        "partially": "teilweise",
        "slightly": "leicht",
        "somewhat": "etwas",
        "fairly": "ziemlich",
        "pretty": "ziemlich",
        "quite": "ziemlich",
        "rather": "ziemlich",
        "relatively": "relativ",
        "comparatively": "vergleichsweise",
        "approximately": "ungefähr",
        "roughly": "grob",
        "exactly": "genau",
        "precisely": "präzise",
        "accurately": "genau",
        "correctly": "korrekt",
        "properly": "richtig",
        "carefully": "vorsichtig",
        "quickly": "schnell",
        "slowly": "langsam",
        "fast": "schnell",
        "rapidly": "schnell",
        "immediately": "sofort",
        "instantly": "sofort",
        "suddenly": "plötzlich",
        "gradually": "allmählich",
        "eventually": "schließlich",
        "finally": "schließlich",
        "ultimately": "letztendlich",
        "recently": "kürzlich",
        "lately": "in letzter Zeit",
        "currently": "derzeit",
        "presently": "derzeit",
        "nowadays": "heutzutage",
        "today": "heute",
        "tomorrow": "morgen",
        "yesterday": "gestern",
        "earlier": "früher",
        "later": "später",
        "soon": "bald",
        "shortly": "in Kürze",
        "already": "bereits",
        "still": "noch",
        "yet": "noch",
        "just": "gerade",
        "only": "nur",
        "even": "sogar",
        "also": "auch",
        "too": "auch",
        "as well": "auch",
        "besides": "außerdem",
        "furthermore": "außerdem",
        "moreover": "außerdem",
        "additionally": "zusätzlich",
        "however": "jedoch",
        "nevertheless": "dennoch",
        "nonetheless": "dennoch",
        "otherwise": "andernfalls",
        "instead": "stattdessen",
        "therefore": "daher",
        "thus": "somit",
        "consequently": "folglich",
        "accordingly": "entsprechend",
        "meanwhile": "währenddessen",
        "simultaneously": "gleichzeitig",
        "together": "zusammen",
        "separately": "getrennt",
        "individually": "individuell",
        "personally": "persönlich",
        "directly": "direkt",
        "indirectly": "indirekt",
        "openly": "offen",
        "secretly": "heimlich",
        "publicly": "öffentlich",
        "privately": "privat",
        "officially": "offiziell",
        "formally": "formal",
        "informally": "informell",
        "seriously": "ernst",
        "honestly": "ehrlich",
        "truly": "wirklich",
        "really": "wirklich",
        "actually": "tatsächlich",
        "indeed": "tatsächlich",
        "certainly": "sicherlich",
        "surely": "sicherlich",
        "definitely": "definitiv",
        "absolutely": "absolut",
        "completely": "vollständig",
        "totally": "völlig",
        "entirely": "ganz",
        "fully": "vollständig",
        "partly": "teilweise",
        "partially": "teilweise",
        "hardly": "kaum",
        "barely": "kaum",
        "scarcely": "kaum",
        "nearly": "fast",
        "almost": "fast",
        "quite": "ziemlich",
        "rather": "ziemlich",
        "fairly": "ziemlich",
        "pretty": "ziemlich",
        "very": "sehr",
        "extremely": "extrem",
        "highly": "hoch",
        "greatly": "sehr",
        "deeply": "tief",
        "widely": "weit",
        "broadly": "breit",
        "generally": "allgemein",
        "specifically": "spezifisch",
        "particularly": "besonders",
        "especially": "besonders",
        "mainly": "hauptsächlich",
        "mostly": "meistens",
        "largely": "größtenteils",
        "primarily": "hauptsächlich",
        "chiefly": "hauptsächlich",
        "principally": "hauptsächlich",
        "basically": "grundsätzlich",
        "essentially": "im Wesentlichen",
        "fundamentally": "grundlegend",
        "originally": "ursprünglich",
        "initially": "anfangs",
        "firstly": "erstens",
        "secondly": "zweitens",
        "thirdly": "drittens",
        "finally": "schließlich",
        "lastly": "zuletzt",
        "ultimately": "letztendlich",
        "eventually": "schließlich",
        "gradually": "allmählich",
        "progressively": "fortschreitend",
        "increasingly": "zunehmend",
        "constantly": "ständig",
        "continuously": "kontinuierlich",
        "regularly": "regelmäßig",
        "frequently": "häufig",
        "occasionally": "gelegentlich",
        "rarely": "selten",
        "seldom": "selten",
        "never": "nie",
        "always": "immer",
        "usually": "normalerweise",
        "normally": "normalerweise",
        "typically": "typischerweise",
        "generally": "allgemein",
        "commonly": "häufig",
        "often": "oft",
        "sometimes": "manchmal",
        "occasionally": "gelegentlich",
        "rarely": "selten",
        "hardly ever": "fast nie",
        "scarcely ever": "fast nie",
        "never": "nie",
        
        # 名词
        "time": "Zeit",
        "day": "Tag",
        "night": "Nacht",
        "week": "Woche",
        "month": "Monat",
        "year": "Jahr",
        "hour": "Stunde",
        "minute": "Minute",
        "moment": "Moment",
        "life": "Leben",
        "world": "Welt",
        "place": "Ort",
        "home": "Zuhause",
        "house": "Haus",
        "family": "Familie",
        "people": "Menschen",
        "person": "Person",
        "man": "Mann",
        "woman": "Frau",
        "child": "Kind",
        "friend": "Freund",
        "group": "Gruppe",
        "team": "Team",
        "organization": "Organisation",
        "community": "Gemeinschaft",
        "society": "Gesellschaft",
        "country": "Land",
        "city": "Stadt",
        "area": "Gebiet",
        "region": "Region",
        "space": "Raum",
        "room": "Zimmer",
        "building": "Gebäude",
        "structure": "Struktur",
        "system": "System",
        "method": "Methode",
        "way": "Weg",
        "process": "Prozess",
        "activity": "Aktivität",
        "action": "Aktion",
        "work": "Arbeit",
        "job": "Job",
        "task": "Aufgabe",
        "project": "Projekt",
        "plan": "Plan",
        "goal": "Ziel",
        "purpose": "Zweck",
        "reason": "Grund",
        "cause": "Ursache",
        "effect": "Wirkung",
        "result": "Ergebnis",
        "outcome": "Ergebnis",
        "success": "Erfolg",
        "failure": "Misserfolg",
        "problem": "Problem",
        "solution": "Lösung",
        "answer": "Antwort",
        "question": "Frage",
        "issue": "Problem",
        "matter": "Angelegenheit",
        "subject": "Thema",
        "topic": "Thema",
        "theme": "Thema",
        "idea": "Idee",
        "thought": "Gedanke",
        "concept": "Konzept",
        "theory": "Theorie",
        "principle": "Prinzip",
        "rule": "Regel",
        "law": "Gesetz",
        "policy": "Politik",
        "strategy": "Strategie",
        "approach": "Ansatz",
        "technique": "Technik",
        "skill": "Fähigkeit",
        "ability": "Fähigkeit",
        "talent": "Talent",
        "knowledge": "Wissen",
        "information": "Information",
        "data": "Daten",
        "fact": "Tatsache",
        "detail": "Detail",
        "feature": "Merkmal",
        "quality": "Qualität",
        "property": "Eigenschaft",
        "characteristic": "Charakteristikum",
        "aspect": "Aspekt",
        "element": "Element",
        "component": "Komponente",
        "part": "Teil",
        "section": "Abschnitt",
        "chapter": "Kapitel",
        "page": "Seite",
        "book": "Buch",
        "article": "Artikel",
        "report": "Bericht",
        "study": "Studie",
        "research": "Forschung",
        "analysis": "Analyse",
        "review": "Überprüfung",
        "evaluation": "Bewertung",
        "assessment": "Bewertung",
        "test": "Test",
        "exam": "Prüfung",
        "experiment": "Experiment",
        "trial": "Versuch",
        "example": "Beispiel",
        "case": "Fall",
        "instance": "Instanz",
        "situation": "Situation",
        "condition": "Zustand",
        "state": "Zustand",
        "status": "Status",
        "position": "Position",
        "level": "Niveau",
        "degree": "Grad",
        "amount": "Menge",
        "number": "Nummer",
        "quantity": "Menge",
        "measure": "Maß",
        "size": "Größe",
        "length": "Länge",
        "width": "Breite",
        "height": "Höhe",
        "depth": "Tiefe",
        "weight": "Gewicht",
        "mass": "Masse",
        "volume": "Volumen",
        "area": "Fläche",
        "distance": "Entfernung",
        "speed": "Geschwindigkeit",
        "rate": "Rate",
        "frequency": "Häufigkeit",
        "pattern": "Muster",
        "trend": "Trend",
        "direction": "Richtung",
        "path": "Pfad",
        "route": "Route",
        "journey": "Reise",
        "trip": "Reise",
        "travel": "Reise",
        "visit": "Besuch",
        "tour": "Tour",
        "adventure": "Abenteuer",
        "experience": "Erfahrung",
        "event": "Ereignis",
        "occasion": "Gelegenheit",
        "opportunity": "Gelegenheit",
        "chance": "Chance",
        "possibility": "Möglichkeit",
        "option": "Option",
        "choice": "Wahl",
        "decision": "Entscheidung",
        "selection": "Auswahl",
        "preference": "Präferenz",
        "interest": "Interesse",
        "hobby": "Hobby",
        "passion": "Leidenschaft",
        "love": "Liebe",
        "feeling": "Gefühl",
        "emotion": "Emotion",
        "mood": "Stimmung",
        "attitude": "Haltung",
        "behavior": "Verhalten",
        "habit": "Gewohnheit",
        "custom": "Brauch",
        "tradition": "Tradition"
    }
    
    def translate_text(text):
        """翻译文本"""
        if not text.strip():
            return text
        
        # 按长度排序，优先匹配长短语
        sorted_keys = sorted(translations.keys(), key=len, reverse=True)
        
        for english in sorted_keys:
            # 使用单词边界匹配
            pattern = r'\b' + re.escape(english) + r'\b'
            if re.search(pattern, text, re.IGNORECASE):
                text = re.sub(pattern, translations[english], text, flags=re.IGNORECASE)
        
        return text
    
    def translate_file(src_file, dest_file):
        """翻译单个文件"""
        print(f"正在处理: {src_file} -> {dest_file}")
        
        try:
            with open(src_file, 'r', encoding='utf-8') as f:
                content = f.read()
            
            # 更新lang属性
            content = re.sub(r'lang="en"', 'lang="de"', content)
            
            # 处理title标签
            def translate_title(match):
                title_content = match.group(1)
                translated = translate_text(title_content)
                return f'<title>{translated}</title>'
            
            content = re.sub(r'<title>(.*?)</title>', translate_title, content, flags=re.DOTALL)
            
            # 处理HTML标签内的文本
            def translate_html_text(match):
                tag_start = match.group(1)
                text_content = match.group(2)
                tag_end = match.group(3)
                
                if text_content.strip():
                    translated_text = translate_text(text_content)
                    return tag_start + translated_text + tag_end
                
                return match.group(0)
            
            # 匹配各种HTML标签
            html_tags = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'div', 'span', 'a', 'li', 'td', 'th', 'cite', 'button']
            
            for tag in html_tags:
                pattern = f'(<{tag}[^>]*>)(.*?)(</{tag}>)'
                content = re.sub(pattern, translate_html_text, content, flags=re.DOTALL)
            
            # 处理注释
            def translate_comment(match):
                comment_text = match.group(1)
                translated = translate_text(comment_text)
                return f'<!-- {translated} -->'
            
            content = re.sub(r'<!--\s*(.*?)\s*-->', translate_comment, content, flags=re.DOTALL)
            
            # 确保目标目录存在
            dest_file.parent.mkdir(parents=True, exist_ok=True)
            
            # 写入文件
            with open(dest_file, 'w', encoding='utf-8') as f:
                f.write(content)
            
            print(f"✅ 完成: {dest_file}")
            
        except Exception as e:
            print(f"❌ 错误: {src_file}: {str(e)}")
    
    # 主函数
    en_dir = Path("en")
    de_dir = Path("de")
    
    if not en_dir.exists():
        print("❌ en目录不存在")
        return
    
    html_files = list(en_dir.rglob("*.html"))
    
    if not html_files:
        print("❌ 未找到HTML文件")
        return
    
    print(f"找到 {len(html_files)} 个英文HTML文件")
    print("开始翻译成德语...")
    
    for html_file in html_files:
        relative_path = html_file.relative_to(en_dir)
        dest_file = de_dir / relative_path
        translate_file(html_file, dest_file)
    
    print(f"\n🎉 德语翻译完成！共处理了 {len(html_files)} 个文件")

if __name__ == "__main__":
    translate_to_german()
